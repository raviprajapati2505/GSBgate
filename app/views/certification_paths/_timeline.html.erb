<div id="vertical-timeline" class="vertical-container dark-timeline">
    <% date_previous = nil %>
    <% certification_path.status_history.each_with_index do |milestone, index| %>
        <div class="vertical-timeline-block">
            <div class="vertical-timeline-icon <% if CertificationPathStatus.at_gord_side?(milestone[:certification_path_status].id) %>yellow-bg<% else %>navy-bg<% end %>">
                <%= fa_icon('user') %>
            </div>
            <div class="vertical-timeline-content">
                <h2>
                    <% if (index == 0) %>
                        <%= milestone[:certification_path_status].name %>
                        <% audit_log_params = { project_id: @project.id, certification_path_id: @certification_path.id, date_from: milestone[:date].strftime(t('date.formats.short')), time_from: milestone[:date].strftime(t('time.formats.short')), button: 'Apply_audit_filter' } %>
                    <% else %>
                        <%= milestone[:certification_path_status].past_name %>
                        <% audit_log_params = { project_id: @project.id, certification_path_id: @certification_path.id, date_from: milestone[:date].strftime(t('date.formats.short')), time_from: milestone[:date].strftime(t('time.formats.short')), date_to: date_previous.strftime(t('date.formats.short')), time_to: date_previous.strftime(t('time.formats.short')), button: 'Apply_audit_filter' } %>
                    <% end %>
                    <%= link_to(audit_logs_path(audit_log_params), class: 'status-audit-log', title: "Click to view the audit logs that were created during the '#{milestone[:certification_path_status].name}' phase.") do %>
                        <span class="label label-lg"><%= fa_icon('history') %></span>
                    <% end %>
                </h2>
                <% unless date_previous.nil? %>
                    <small class="text-muted">
                        <%= fa_icon('clock-o', 'Date/time') %> <%= localize(date_previous) %>
                    </small>
                <% end %>
                <% if (index == 0) %>
                    <p><%= milestone[:certification_path_status].description %></p>
                <% end %>
            </div>
        </div>
        <% date_previous = milestone[:date] %>
    <% end %>
</div>